---
layout: base
---

<article class="post">
    <header class="post-header">
        <h1 class="post-title">{{ title }}</h1>
        <div class="post-meta">
            <span><strong>Artist:</strong> {{ artist }}</span>
            {% if album and album != "Unknown Album" %}
            <span><strong>Album:</strong> {{ album }}</span>
            {% endif %}
            <span><strong>Release:</strong> {{ date }}</span>
            {% if genre %}
            <span><strong>Genre:</strong> {{ genre | join(", ") }}</span>
            {% endif %}
        </div>
    </header>

    {% if filename %}
    <div class="music-player">
        <div class="music-controls">
            <audio controls preload="metadata" class="music-audio-player" data-filename="{{ filename }}">
                <source src="/music-files/{{ filename }}" type="{{ technical.mimeType or 'audio/mpeg' }}">
                {% comment %}
                Future: Add multiple source formats for better browser compatibility
                <source src="/music-files/{{ filename | replace: technical.format | lower, 'mp3' }}" type="audio/mpeg">
                <source src="/music-files/{{ filename | replace: technical.format | lower, 'ogg' }}" type="audio/ogg">
                {% endcomment %}
                <p>Your browser doesn't support HTML5 audio. <a href="/music-files/{{ filename }}" download>Download the track</a> instead.</p>
            </audio>
            <a href="/music-files/{{ filename }}" class="download-link" download>
                Download {{ technical.format or "Audio" }}
                {% if fileSize %}({{ fileSize | formatFileSize }}){% endif %}
            </a>
        </div>
        <div class="music-info">
            {% if duration %}<div><strong>Duration:</strong> {{ duration | formatDuration }}</div>{% endif %}
            {% if genre %}<div><strong>Genre:</strong> {{ genre | join(", ") }}</div>{% endif %}
            {% if technical %}<div><strong>Quality:</strong> {{ technical.sampleRate / 1000 }}kHz / {{ technical.bitDepth }}bit</div>{% endif %}
        </div>
    </div>
    {% endif %}

    <div class="post-content">
        {{ content | safe }}
        
        <div class="music-metadata">
            <h3>Technical Details</h3>
            <div class="technical-info">
                {% if technical %}
                <div><strong>Format:</strong> {{ technical.format or "Unknown" }}</div>
                <div><strong>Sample Rate:</strong> {{ technical.sampleRate }} Hz</div>
                {% if technical.bitDepth %}<div><strong>Bit Depth:</strong> {{ technical.bitDepth }} bit</div>{% endif %}
                <div><strong>Channels:</strong> {{ technical.channels }}</div>
                {% if technical.bitrate %}
                <div><strong>Bitrate:</strong> {{ technical.bitrate | formatFileSize }}bps</div>
                {% endif %}
                {% endif %}
                {% if fileSize %}
                <div><strong>File Size:</strong> {{ fileSize | formatFileSize }}</div>
                {% endif %}
                {% if duration %}
                <div><strong>Duration:</strong> {{ duration | formatDuration }}</div>
                {% endif %}
            </div>
        </div>

        {% if composer or performer %}
        <div class="music-credits">
            <h3>Credits</h3>
            {% if composer %}
            <div><strong>Composer:</strong> {{ composer }}</div>
            {% endif %}
            {% if performer %}
            <div><strong>Performer:</strong> {{ performer }}</div>
            {% endif %}
        </div>
        {% endif %}
    </div>
</article>