<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    {%- set pageTitle = title or site.name %}
    {%- set pageDescription = description or site.description %}
    {%- set pageUrl = site.url + page.url %}
    
    <title>{% if title %}{{ title }} | {{ site.name }}{% else %}{{ site.name }}{% endif %}</title>
    <meta name="description" content="{{ pageDescription }}">
    <meta name="author" content="{{ site.author.name }}">
    
    <!-- Canonical URL -->
    <link rel="canonical" href="{{ pageUrl }}">
    
    <!-- RSS Feeds -->
    <link rel="alternate" type="application/rss+xml" title="{{ site.name }} - Blog Posts" href="/feed.xml">
    <link rel="alternate" type="application/rss+xml" title="{{ site.name }} - Music Releases" href="/music-feed.xml">
    
    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="{% if tags and 'music' in tags %}music.song{% else %}website{% endif %}">
    <meta property="og:url" content="{{ pageUrl }}">
    <meta property="og:title" content="{{ pageTitle }}">
    <meta property="og:description" content="{{ pageDescription }}">
    <meta property="og:site_name" content="{{ site.name }}">
    
    <!-- Twitter Card -->
    <meta name="twitter:card" content="summary">
    <meta name="twitter:url" content="{{ pageUrl }}">
    <meta name="twitter:title" content="{{ pageTitle }}">
    <meta name="twitter:description" content="{{ pageDescription }}">
    
    <!-- Music-specific meta tags -->
    {%- if artist %}
    <meta property="music:musician" content="{{ artist }}">
    <meta name="twitter:label1" content="Artist">
    <meta name="twitter:data1" content="{{ artist }}">
    {%- endif %}
    {%- if album and album != "Unknown Album" %}
    <meta property="music:album" content="{{ album }}">
    <meta name="twitter:label2" content="Album">
    <meta name="twitter:data2" content="{{ album }}">
    {%- endif %}
    {%- if duration %}
    <meta property="music:duration" content="{{ duration }}">
    {%- endif %}
    
    <!-- Schema.org structured data -->
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "{% if tags and 'music' in tags %}MusicRecording{% else %}WebSite{% endif %}",
      "name": "{{ pageTitle }}",
      "description": "{{ pageDescription }}",
      "url": "{{ pageUrl }}"
      {%- if site.author %},
      "author": {
        "@type": "Person",
        "name": "{{ site.author.name }}"
      }
      {%- endif %}
      {%- if artist and tags and 'music' in tags %},
      "byArtist": {
        "@type": "Person",
        "name": "{{ artist }}"
      }
      {%- endif %}
      {%- if album and album != "Unknown Album" %},
      "inAlbum": {
        "@type": "MusicAlbum",
        "name": "{{ album }}"
      }
      {%- endif %}
      {%- if duration %},
      "duration": "PT{{ duration }}S"
      {%- endif %}
      {%- if genre %},
      "genre": {{ genre | dump }}
      {%- endif %}
    }
    </script>
    
    <link rel="stylesheet" href="/assets/css/main.css">
</head>
<body>
    <header class="header">
        <nav class="nav">
            <div class="nav-left">
                <button id="sidebar-toggle" class="sidebar-toggle" aria-label="Toggle sidebar menu" aria-expanded="false">
                    <span class="hamburger-icon">
                        <span></span>
                        <span></span>
                        <span></span>
                    </span>
                    <span class="toggle-text">Menu</span>
                </button>
                <a href="/" class="nav-logo">Music Blog</a>
            </div>
        </nav>
    </header>

    <!-- Layout Container -->
    <div class="layout-container">
        <!-- Sidebar Overlay for Mobile -->
        <div id="sidebar-overlay" class="sidebar-overlay"></div>

        <!-- Screen-Attached Sidebar -->
        <aside id="sidebar" class="sidebar" role="complementary" aria-label="Navigation and recent content">
        <!-- Sidebar Header -->
        <div class="sidebar-header">
            <h2 class="sidebar-brand">zuned11.blog</h2>
        </div>
        
        <!-- Search Section -->
        <section id="sidebar-search" class="sidebar-section sidebar-search-section">
            <h3 class="sidebar-section-title">Search</h3>
            <div class="search-container">
                <input type="text" id="search-input" class="search-input" placeholder="Search posts and music..." autocomplete="off" aria-label="Search content">
                <div id="search-results" class="search-results" role="region" aria-label="Search results" aria-live="polite">
                    <!-- Search results will be populated here -->
                </div>
            </div>
        </section>

        <!-- Navigation Section -->
        <section id="sidebar-nav" class="sidebar-section sidebar-nav-section">
            <h3 class="sidebar-section-title">Navigation</h3>
            <nav class="sidebar-nav" role="navigation" aria-label="Main navigation">
                <ul class="sidebar-nav-list">
                    <li><a href="/" class="sidebar-nav-link" data-page="home">Home</a></li>
                    <li><a href="/blog/" class="sidebar-nav-link" data-page="blog">Blog</a></li>
                    <li><a href="/music/" class="sidebar-nav-link" data-page="music">Music</a></li>
                    <li><a href="/about/" class="sidebar-nav-link" data-page="about">About</a></li>
                    <li><a href="/links/" class="sidebar-nav-link" data-page="links">Links</a></li>
                </ul>
            </nav>
        </section>
        
        <!-- Music Feed Section -->
        <section id="sidebar-music" class="sidebar-section sidebar-music-section">
            <h3 class="sidebar-section-title">Latest Releases</h3>
            <div class="music-feed">
                {% for track in collections.music | head(4) %}
                <div class="sidebar-item">
                    <a href="{{ track.url }}" class="sidebar-item-link">
                        <span class="sidebar-item-title">{{ track.data.title }}</span>
                        <span class="sidebar-item-separator">|</span>
                        <span class="sidebar-item-date">{{ track.date | sidebarDate }}</span>
                    </a>
                </div>
                {% endfor %}
                {% if collections.music.length == 0 %}
                <div class="sidebar-empty">No music releases yet</div>
                {% endif %}
            </div>
            <a href="/music/" class="sidebar-view-all">View all music →</a>
        </section>
        
        <!-- Blog Posts Section -->
        <section id="sidebar-blog" class="sidebar-section sidebar-blog-section">
            <h3 class="sidebar-section-title">Recent Posts</h3>
            <div class="blog-feed">
                {% for post in collections.blog | head(5) %}
                <div class="sidebar-item">
                    <a href="{{ post.url }}" class="sidebar-item-link">
                        <span class="sidebar-item-title">{{ post.data.title }}</span>
                        <span class="sidebar-item-separator">|</span>
                        <span class="sidebar-item-date">{{ post.date | sidebarDate }}</span>
                    </a>
                </div>
                {% endfor %}
                {% if collections.blog.length == 0 %}
                <div class="sidebar-empty">No blog posts yet</div>
                {% endif %}
            </div>
            <a href="/blog/" class="sidebar-view-all">View all posts →</a>
        </section>
        </aside>

        <main class="main">
            <div class="content">
                {{ content | safe }}
            </div>
        </main>
    </div>

    <footer class="footer">
        <p>&copy; 2024 zuned11. All rights reserved.</p>
    </footer>

    <script src="https://unpkg.com/lunr@2.3.9/lunr.min.js"></script>
    <script src="/assets/js/main.js"></script>
</body>
</html>